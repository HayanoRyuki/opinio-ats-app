# 分析・レポート

本ドキュメントは、Opinio ATS における **機能定義 2-8：分析・レポート** を扱う。

## 機能の位置づけ
分析・レポートは、  
Opinio ATS において **採用活動の結果を振り返り、改善点を検討するための参照・検証用機能**である。

本機能は、
- 過去に何が起きたかを整理する
- 採用プロセスの癖や偏りに気づく
- 次の採用活動を考える材料を得る

ことを目的とし、  
**採用の成否・人の良し悪し・処遇判断を行うための機能ではない。**

---

## 主な分析観点

### プロセス観点
- 応募から内定・終了までのリードタイム
- ステップごとの通過・滞留傾向
- 面接回数の分布

### チャネル観点
- 採用チャネル別の応募数
- チャネル別の進行率・滞留傾向
- エージェント・媒体ごとの傾向比較

### 構造把握
- 特定ステップでの詰まり
- 面接回数が多くなりがちな求人
- 時期・求人ごとの進行差

---

## 前提条件（厳守）
以下は、本機能を誤用しないための前提条件である。

- 処遇判断・人事評価には使わない
- 採否の正当性を保証するものではない
- あくまで **事実の整理と傾向把握** に限定する

---

## ダッシュボードとの違い
- ダッシュボード  
  → 「今どうなっているか」を一目で把握する
- 分析・レポート  
  → 「なぜそうなったか」「過去はどうだったか」を振り返る

分析・レポートは、  
**即時判断ではなく、後から考えるための画面**である。

---

## データモデル（必須）

### ReportDefinition
- report_key
- title
- description
- available_filters
- is_active
- created_at
- updated_at

### ReportResultSnapshot
- snapshot_id
- report_key
- company_id
- result_data（JSON）
- period_start
- period_end
- calculated_at

※ 点数・ランク・評価値は保持しない  
※ JSON は「事実の集合体」に留める

---

## 主なレポート種別（初期）

### 採用リードタイムレポート
- 応募〜終了までの日数分布
- ステップ別所要日数

### チャネル別分析レポート
- 応募数・進行数
- 滞留ステップの偏り

### 面接プロセス分析
- 面接回数分布
- 面接回数と結果の関係（因果は示さない）

---

## フィルタ設計
- 期間
- 求人
- 採用チャネル
- ステータス（進行中／終了）

※ フィルタ結果は  
※ **即時集計 or 事前スナップショット** で切り替え可能

---

## コントローラ設計

### ReportController
- index  
  レポート一覧
- show  
  レポート表示
- export  
  CSV / PDF 出力（参照用）

---

## ビュー設計

### 表示系
- reports/index  
  レポート一覧
- reports/show  
  各レポート詳細
- reports/partials/filters  
  共通フィルタUI

---

## Controller / View 以外に必要な要素

### Service
#### ReportAggregationService
- 集計ロジックの集中管理
- フィルタ条件処理
- 再計算可能設計

---

### Job / Batch
#### ReportSnapshotJob
- 定期スナップショット生成
- 過去比較用データ保存
- 重い集計の非同期処理

---

### Policy
- ReportPolicy  
  閲覧権限制御
- ReportExportPolicy  
  エクスポート権限制御

---

## ログ・監査の考え方
- レポート結果そのものは証拠としない
- レポート定義・集計条件の変更履歴は保持
- 「どの条件で見たか」を説明可能にする

---

## 他機能との関係
- ダッシュボード：  
  サマリーの起点
- 候補者管理：  
  集計元データ
- パイプライン管理：  
  プロセス分析元
- KPI定義：  
  指標定義の共通利用

---

## 本機能で「やらないこと」
以下は、Opinio ATS の思想に基づく設計判断である。

- 採用成功・失敗の断定
- 面接官・エージェント評価
- 処遇判断への接続
- 人事制度運用への踏み込み

---

## 一文定義（迷ったとき用）
分析・レポートは、  
**採用活動を評価するための機能ではなく、過去を冷静に振り返るための道具である。**
