# 外部連携（Integration）

本ドキュメントは、Opinio ATS における  
**機能定義：外部連携（Integration）** を扱う。

## 機能の位置づけ
外部連携は、  
Opinio ATS を **社内外の既存ツール・業務環境と安全につなぐための基盤機能**である。

本機能は、
- 採用判断を自動化する
- 外部ツールに主導権を渡す

ためのものではなく、  
**採用業務の流れを壊さず、補助的につなぐ** ことを目的とする。

---

## 連携の基本思想（最重要）
- Opinio ATS が **採用業務の正（Single Source of Truth）** である
- 外部ツールは「補助」「同期先」「入力元」に留める
- 連携失敗時でも、ATS 単体で業務が継続できる設計とする
- 自動連携は常に「解除・停止」可能であること

---

## 想定する連携カテゴリ

### カレンダー連携
- Google Calendar
- Microsoft Outlook / Microsoft 365

用途：
- 面接予定の登録・更新
- 参加者への予定共有

前提：
- 予定の正は ATS 側
- カレンダー側の変更は「参照 or 反映可否を選択」

---

### コミュニケーション連携
- メール（SMTP / API）
- チャットツール（Slack / Teams 等）

用途：
- 通知の送信
- 面接日程・進行状況の共有

前提：
- 内容の生成・判断は ATS 側
- チャットは「通知・共有」に限定

---

### オンライン面接連携
- Zoom
- Google Meet
- Microsoft Teams

用途：
- 面接 URL の自動発行
- 面接情報の紐付け

前提：
- 面接評価・結果は ATS で管理
- 会議ツール側に判断ロジックを持たせない

---

### 人事・労務システム連携（将来）
- 人事基幹
- 労務管理
- 入社手続きシステム

用途：
- 内定後・入社後の情報連携

前提：
- 採用フェーズ完了後の「引き渡し」
- 採用中データの逆流は行わない

---

## 連携方式

### OAuth / API 連携
- トークン管理による安全な接続
- 権限スコープを最小化

---

### Webhook / Event 連携
- ATS 内イベントを外部へ通知
- 失敗時のリトライ・無効化対応

---

### CSV / 手動連携
- インポート / エクスポート
- 一時的・例外的な運用を想定

---

## データの扱い方針
- 連携データは **コピー or 参照** とする
- 外部データで ATS の正データを上書きしない
- 連携時の変換ルールは明示・固定する

---

## 設定項目（想定）

### 連携単位の設定
- 連携 ON / OFF
- 対象求人・対象ユーザー
- 自動生成・自動通知の範囲

---

### 認証・権限
- 接続ユーザー
- アクセス権限スコープ
- トークン失効・再認証

---

## データモデル（必須）

### IntegrationProvider
- provider_key（google_calendar / slack / zoom 等）
- name
- category
- is_active

---

### IntegrationSetting
- setting_id
- company_id
- provider_key
- config（JSON）
- status（active / inactive）
- created_at
- updated_at

---

### IntegrationEventLog
- log_id
- provider_key
- event_type
- payload
- status（success / failed）
- occurred_at

---

## この機能でやること
- 外部ツールとの安全な接続
- 採用業務を補助する情報連携
- 連携状態・失敗の可視化

---

## この機能でやらないこと
- 採用判断の外部委譲
- 外部ツール主導の業務設計
- 不可逆な自動同期
- 連携前提でしか動かない機能設計

---

## 他機能との関係
- 日程調整  
  → カレンダー・面接ツール連携
- 通知  
  → メール・チャット連携
- 設定・チーム管理  
  → 連携権限・管理主体の制御
- 監査・セキュリティ  
  → 連携ログ・トークン管理

---

## 一文定義（迷ったとき用）
外部連携は、  
**採用業務の主導権を保ったまま、外部ツールと安全につなぐための機能である。**
