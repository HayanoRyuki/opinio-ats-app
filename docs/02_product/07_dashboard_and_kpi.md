# ダッシュボード・KPI

本ドキュメントは、Opinio ATS における **機能定義 2-7：ダッシュボード・KPI** を扱う。

## 機能の位置づけ
ダッシュボード・KPI は、  
Opinio ATS において **採用活動全体の「健康状態」を俯瞰し、今日取るべき行動に気づくための可視化機能**である。

本機能は、
- 現在、採用活動のどこが動いていて／止まっているかを把握する
- 今日・今週に対応すべきポイントに気づく
- 採用活動を後から説明できる状態をつくる

ことを目的とし、  
**採用の成否・良し悪し・人の優劣を自動で判断する機能ではない**。

ダッシュボードは、  
分析や評価のための画面ではなく、  
**「いま何をすべきか」を判断するための起点**として設計される。

---

## 表示対象（KPIとアクションの考え方）

### 今すぐのアクション（最優先）
以下は、数値ではなく「対応が必要な状態」を示す表示である。

- 日程調整待ちの候補者
- 評価・メモ未入力の面接
- 返信待ちのやりとり
- 長期間ステップが動いていない候補者

※ ダッシュボードは「警告灯」として機能する  
※ ここでの表示は評価や責任追及を目的としない

---

### 主要KPI（初期表示）
Opinio ATS では、初期状態では **4つの主要KPI** に絞って表示する。

- 応募数（期間別）
- 選考進行中の候補者数
- ステップ別滞留人数・滞留日数
- 採用チャネル別応募数・進行数

これらは、
- 採用活動の流量
- 停滞の有無
- 構造的な偏り

を把握するための **健康指標** である。

---

### 補助的表示
- 今週・今月の面接予定
- 最近動きが止まっている候補者
- エージェント・媒体別の進行状況

※ 補助的表示は「次に見るべき場所」を示すためのものとする

---

## 設計方針（最重要）
以下は、本機能を「評価」ではなく「可視化」として成立させるための方針である。

- 判断を促す材料の提示に留める
- 成否・良否・優劣の自動評価は行わない
- 数値は必ず **説明可能な定義** を持つ
- 集計ロジックをブラックボックスにしない
- 数値は「結論」ではなく「問い」を生むために使う

---

## KPIの扱いに関する注意（重要）
- 通過率・滞留日数・前週比などの数値は、  
  **優劣や評価を示すものではない**
- 面接官別・チャネル別の数値は、  
  **ばらつきや構造的偏りに気づくための参考情報**として扱う
- ランキングや順位付けを目的とした表示は行わない

---

## KPIの位置づけ
Opinio ATS における KPI は、
- 経営指標
- 人事評価
- 処遇判断

のための指標ではない。

あくまで、
- 採用活動を振り返るための事実整理
- 次のアクションを考えるための材料

として扱う。

---

## データモデル（必須）

### DashboardMetricDefinition
- metric_key  
  （例：applications_count / in_progress_count）
- label
- description
- aggregation_rule  
  （例：count / avg / days_diff）
- is_active
- created_at
- updated_at

### DashboardMetricSnapshot
- snapshot_id
- metric_key
- company_id
- value
- period_start
- period_end
- calculated_at

※ 点数化・スコア化・ランキング用カラムは持たない  
※ 「平均との差」「評価値」などは扱わない

---

## 集計対象となる主データ
- applications
- candidates
- pipeline_steps
- interviews
- application_channels

※ 正データは各テーブル  
※ ダッシュボードは **参照専用**

---

## コントローラ設計

### DashboardController
- index  
  ダッシュボード初期表示
- summary  
  KPIサマリー取得
- pipeline  
  ステップ別状況取得
- channel  
  チャネル別傾向取得

### DashboardMetricController（管理用）
- index  
  指標一覧
- update  
  表示ON/OFF切り替え

---

## Controller / View 以外に必要な要素

### Service
#### DashboardAggregationService
- KPI定義に基づく集計
- 期間指定集計
- ロジックの一元管理

#### PipelineAnalyticsService
- 滞留日数計算
- ステップ遷移履歴集計

---

### Job / Batch
#### DashboardSnapshotJob
- 定期的なスナップショット生成
- 過去比較用データ保存
- 再計算可能設計

---

### Policy
- DashboardPolicy  
  閲覧権限（管理者／メンバー）
- DashboardMetricPolicy  
  指標編集権限

---

## ログ・監査の考え方
- 表示値そのものは監査対象としない
- 集計定義（metric定義）の変更履歴は保持
- 「いつ・どの定義で見ていたか」を後から説明できる状態にする

---

## 他機能との関係
- 候補者管理：  
  集計元データ
- パイプライン管理：  
  滞留・進行状況算出元
- チャネル管理：  
  応募経路分析
- レポート機能：  
  より詳細な振り返り用途

---

## 本機能で「やらないこと」
以下は、Opinio ATS の思想に基づく設計判断である。

- 合否率による自動評価
- 面接官・エージェントのランキング
- 採用成否の良否判断
- 人事評価・処遇判断への接続

---

## 一文定義（迷ったとき用）
ダッシュボード・KPIは、  
**採用活動を評価するための指標ではなく、  
いま取るべき行動に気づくために事実を並べる機能である。**
